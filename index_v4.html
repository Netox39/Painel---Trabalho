<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Painel de Trabalho — Faculdade Christus</title>
<style>
:root{
  --bg:#0b1220;
  --text:#eaf0ff;
  --muted:#93a4c7;
  --border:rgba(255,255,255,.10);
  --headerH:72px;
  --btn:#4f8cff;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
  background: radial-gradient(1200px 600px at 20% -10%, rgba(79,140,255,.22), transparent 60%),
              radial-gradient(900px 500px at 90% 10%, rgba(34,197,94,.16), transparent 55%),
              var(--bg);
  color:var(--text);
  height:100vh;
  overflow:hidden;
}
header{
  height:var(--headerH);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:12px 14px;
  border-bottom:1px solid var(--border);
}
.brand{display:flex;align-items:center;gap:10px}
.brand img{width:46px;height:46px;border-radius:12px;border:1px solid var(--border)}
.brand small{display:block;color:var(--muted)}
.clock{color:var(--muted);font-size:12px}

.app{display:grid;grid-template-columns:320px 1fr;height:calc(100vh - var(--headerH))}
aside{border-right:1px solid var(--border);padding:12px;overflow:auto}
.nav button{
  display:flex;justify-content:space-between;width:100%;margin-bottom:8px;padding:10px;
  border:1px solid var(--border);background:rgba(255,255,255,.04);border-radius:12px;
  cursor:pointer;color:var(--text)
}
.nav button.active{background:rgba(79,140,255,.18)}
.badge{font-size:11px;color:var(--muted)}

main{padding:12px;overflow:hidden}
.topbar{display:flex;justify-content:space-between;margin-bottom:10px}
.controls button{
  padding:10px;border:none;border-radius:10px;background:rgba(255,255,255,.10);
  color:var(--text);cursor:pointer
}
.controls button:hover{background:rgba(79,140,255,.22)}

.content{
  height: calc(100vh - var(--headerH) - 78px);
  border:1px solid var(--border);
  border-radius:14px;
  overflow:auto;
}

.zoomWrap{transform-origin:0 0}
.iframeBox{width:1600px;height:1100px}
.iframeBox iframe{width:100%;height:100%;border:0;background:white}

table{border-collapse:collapse}
th,td{padding:8px 10px;border:1px solid rgba(255,255,255,.1)}
th{background:rgba(79,140,255,.2)}
</style>
</head>
<body>

<header>
  <div class="brand">
    <img src="logo.png">
    <div>
      <div><b>Painel de Trabalho</b></div>
      <small>Faculdade Christus</small>
    </div>
  </div>
  <div class="clock" id="clock"></div>
</header>

<div class="app">
  <aside>
    <div class="nav" id="nav"></div>
  </aside>

  <main>
    <div class="topbar">
      <div id="title"></div>
      <div class="controls">
        <button id="zoomOut">−</button>
        <button id="zoomReset">100%</button>
        <button id="zoomIn">+</button>
        <button id="openBtn">Abrir no Sheets</button>
      </div>
    </div>
    <div class="content" id="content"></div>
  </main>
</div>

<script>
const u = (b) => b + "?widget=true&headers=false";

const tabs = [
  {
    name:"Controle de Inventário",
    type:"table",
    csvUrl:"https://docs.google.com/spreadsheets/d/e/2PACX-1vTuk8e_LjYUhZjKL1irUu61to09DTsk7fXnmbN_ZgJ8FSW-qFw1Bi5VznDXC7tRGyhMvgTg5QlAADE9/pub?gid=1099818557&single=true&output=csv",
    editUrl:"https://docs.google.com/spreadsheets/d/1QVhGPsB8g9BsU5gIoPFNBslsg18zsqLz96yqlwRXdHs/edit"
  },
  {
    name:"Controle de Envios e Retornos",
    type:"iframe",
    url:u("https://docs.google.com/spreadsheets/d/e/2PACX-1vR8oJdwz52RcOHzwlutBJ-oznwbO2psOOkFnVb2JLY5Rpzd9zac6JZQ30YBladU5lvt2FiTUALCv57R/pubhtml")
  },
  {
    name:"Mapeamento Ar Condicionado",
    type:"iframe",
    url:u("https://docs.google.com/spreadsheets/d/e/2PACX-1vSWcrg5z_S3YUhEqDrshtpKO9uejmEv2KhI70RfdeGuPxhm_UuAx7yl5y8Jpe5BMA/pubhtml")
  },
  {
    name:"Agenda Lab de Informática",
    type:"iframe",
    url:u("https://docs.google.com/spreadsheets/d/e/2PACX-1vS4gESNTCskkqwJDwDEdszFOOWBsPRbNZj1pzr0KfvOyfxVCMfBq9yRZ9N6OQRmkrWjNCRSNHv0t88-/pubhtml")
  },
  {
    name:"Ramais Internos",
    type:"iframe",
    url:u("https://docs.google.com/spreadsheets/d/e/2PACX-1vS-wJl57NMoEHSiVWPKm4R32h9cQbavN7GLWoXWoZS37zZcvUpoJl9P2_cTx7VXTVzcPk9nNmQdpmhV/pubhtml")
  }
];

function parseCSV(text){
  return text.split("\n").map(r=>r.split(","));
}

function findHeaderRow(rows){
  for(let i=0;i<rows.length;i++){
    const r = rows[i].map(c=>c.toLowerCase());
    if(r.includes("equipamentos")||r.includes("equipamento")){
      return i;
    }
  }
  return 0;
}

const nav = document.getElementById("nav");
const content = document.getElementById("content");
const titleEl = document.getElementById("title");

let current=null;
let zoom=1;

function applyZoom(){
  const wrap=document.getElementById("zoomWrap");
  if(wrap) wrap.style.transform=`scale(${zoom})`;
  document.getElementById("zoomReset").textContent=Math.round(zoom*100)+"%";
}

document.getElementById("zoomIn").onclick=()=>{zoom+=0.1;applyZoom()}
document.getElementById("zoomOut").onclick=()=>{zoom-=0.1;applyZoom()}
document.getElementById("zoomReset").onclick=()=>{zoom=1;applyZoom()}
document.getElementById("openBtn").onclick=()=>{
  if(current?.editUrl) window.open(current.editUrl)
}

tabs.forEach((t,i)=>{
  const b=document.createElement("button");
  b.innerHTML=`<span>${t.name}</span>`;
  b.onclick=()=>render(i);
  nav.appendChild(b);
});

async function renderTable(tab){
  content.innerHTML='<div id="zoomWrap" class="zoomWrap"><div id="tableHost"></div></div>';
  const res=await fetch(tab.csvUrl);
  const txt=await res.text();
  const rows=parseCSV(txt);

  const headerIndex=findHeaderRow(rows);
  const header=rows[headerIndex];
  const data=rows.slice(headerIndex+1);

  const table=document.createElement("table");

  const trh=document.createElement("tr");
  header.forEach(h=>{
    const th=document.createElement("th");
    th.textContent=h;
    trh.appendChild(th);
  });
  table.appendChild(trh);

  data.forEach(r=>{
    if(r.length===0) return;
    const tr=document.createElement("tr");
    r.forEach(c=>{
      const td=document.createElement("td");
      td.textContent=c;
      tr.appendChild(td);
    });
    table.appendChild(tr);
  });

  document.getElementById("tableHost").appendChild(table);
}

function renderIframe(tab){
  content.innerHTML=`
  <div id="zoomWrap" class="zoomWrap">
    <div class="iframeBox">
      <iframe src="${tab.url}"></iframe>
    </div>
  </div>`;
}

function render(i){
  current=tabs[i];
  titleEl.textContent=current.name;
  if(current.type==="table") renderTable(current);
  else renderIframe(current);
}

render(0);

setInterval(()=>{
  document.getElementById("clock").innerText=new Date().toLocaleString("pt-BR");
},1000);
</script>

</body>
</html>
